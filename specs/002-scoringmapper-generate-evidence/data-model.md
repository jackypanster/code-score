# Data Model: Remove Phantom Evidence Paths

## Core Entities

### EvidencePathsMapping
**Purpose**: Validated mapping of evidence categories to verified file system paths
**Fields**:
- `evidence_key`: string - Unique identifier for evidence type (e.g., "code_quality_lint_results")
- `file_path`: string - Absolute path to evidence file (must exist)
- `dimension`: string - Category dimension (code_quality, testing, documentation, system)
- `source_type`: string - Type of evidence source (lint_results, test_output, etc.)

**Validation Rules**:
- `file_path` must point to existing file before inclusion in mapping
- `evidence_key` must match pattern: `{item_id}_{source_type}`
- `dimension` must be one of: code_quality, testing, documentation, system

**State Transitions**:
- Generated → Validated → Included (only validated paths included in output)
- Invalid/Non-existent → Excluded (phantom paths removed)

### ScoreInputEvidence (Enhanced)
**Purpose**: Evidence paths section of score_input.json with file existence guarantee
**Fields**:
- `evidence_paths`: Dict[str, str] - Mapping of evidence keys to verified file paths
- `total_evidence_files`: int - Count of available evidence files
- `evidence_base_path`: string - Base directory for evidence files

**Validation Rules**:
- All paths in `evidence_paths` must point to existing files
- Path values must be absolute paths
- Keys must correspond to actual evidence generated by EvidenceTracker

**Relationships**:
- Contains validated subset of EvidencePathsMapping entries
- Excludes any phantom or non-existent file references

### EvidenceFile
**Purpose**: Individual evidence file with metadata
**Fields**:
- `file_path`: string - Absolute path to file
- `evidence_key`: string - Corresponding evidence mapping key
- `file_size`: int - File size in bytes
- `created_at`: datetime - File creation timestamp
- `content_type`: string - Evidence content type (checklist_item, summary, manifest)

**Validation Rules**:
- File must exist at `file_path`
- `file_size` must be > 0 (non-empty files)
- `content_type` must be: checklist_item, summary, or manifest

## Validation Workflow

### Pre-Output Validation
1. **Evidence Generation**: EvidenceTracker creates files and returns file mapping
2. **Path Validation**: ScoringMapper validates each path in evidence_paths exists
3. **Phantom Removal**: Non-existent paths excluded from final evidence_paths
4. **Consistency Check**: Ensure evidence_paths only contains validated entries

### Error States
- **FileNotFoundError**: When phantom path references non-existent file
- **ValidationError**: When evidence_paths contains invalid entries
- **InconsistencyError**: When EvidenceTracker and ScoringMapper mappings don't align

## Interface Changes

### ScoringMapper._generate_evidence_paths()
**Before** (with phantom paths):
```python
evidence_paths.update({
    "evaluation_summary": f"{evidence_base_path}/evaluation_summary.json",
    "category_breakdowns": f"{evidence_base_path}/category_breakdowns.json",
    "warnings_log": f"{evidence_base_path}/warnings.log"
})
```

**After** (validated paths only):
- Remove hardcoded phantom path additions
- Add file existence validation before path inclusion
- Return only verified file paths

### ScoreInput.evidence_paths
**Contract**: All entries guaranteed to point to existing files
**Validation**: Pre-output file existence check ensures contract compliance

## Backward Compatibility

### Compatible Changes
- **Field structure**: evidence_paths remains Dict[str, str]
- **File organization**: EvidenceTracker file creation unchanged
- **JSON schema**: score_input.json structure unchanged

### Removed Phantom Entries
- `evaluation_summary` key removed (phantom file)
- `category_breakdowns` key removed (phantom file)
- `warnings_log` key removed (phantom file)

**Impact**: Integration systems will see fewer evidence_paths entries, but all remaining entries will be accessible files.

## Performance Implications

### File Existence Validation
- **Operation**: O(n) file system checks where n = evidence file count
- **Typical Scale**: 5-15 evidence files per evaluation
- **Performance Impact**: Minimal (< 10ms for typical evaluations)

### Memory Usage
- **Reduction**: Smaller evidence_paths dictionary (3 fewer phantom entries)
- **No additional memory**: File existence checks use system calls without caching

## Testing Validation

### Unit Test Requirements
- Validate phantom path removal from _generate_evidence_paths()
- Test file existence validation logic
- Verify evidence_paths only contains existing files

### Integration Test Requirements
- End-to-end validation of evidence file accessibility
- CLI evaluation workflow with evidence path verification
- EvidenceTracker-ScoringMapper consistency testing

### Contract Test Requirements
- Schema validation for score_input.json structure
- Evidence paths field validation for file existence
- Backward compatibility verification for existing integrations